'use strict';var gulp=require('gulp'),path=require('path'),runSequence=require('run-sequence'),changed=require('gulp-changed'),gulpif=require('gulp-if'),imagemin=require('gulp-imagemin'),rename=require('gulp-rename'),svgmin=require('gulp-svgmin'),svgstore=require('gulp-svgstore'),config=require('../config'),pathBuilder=require('../pathBuilder');gulp.task('images',function(a){runSequence('clean:images',['images:optimise','images:svg-sprite'],a)}),gulp.task('images:optimise',function(){return gulp.src(pathBuilder.imgSrcDir+'/**').pipe(changed(''+pathBuilder.imgDistDir)).pipe(imagemin([imagemin.gifsicle({optimizationLevel:3}),imagemin.jpegtran(),imagemin.optipng({optimizationLevel:5}),imagemin.svgo()],{verbose:config.isDev})).pipe(gulpif(config.docs.outputAssets,gulp.dest(pathBuilder.docsImgDistDir))).pipe(gulp.dest(''+pathBuilder.imgDistDir))}),gulp.task('images:svg-sprite',function(){return gulp.src(pathBuilder.imgSrcDir+'/**/*.svg',{base:pathBuilder.imgSrcDir}).pipe(rename(function(a){var b=a.dirname.split(path.sep),c=b.indexOf('.');b.push(a.basename),-1<c&&b.splice(c,1),a.basename=b.join('-')})).pipe(svgmin()).pipe(svgstore()).pipe(rename(config.img.svgSpriteFilename)).pipe(gulpif(config.docs.outputAssets,gulp.dest(pathBuilder.docsImgDistDir))).pipe(gulp.dest(''+pathBuilder.imgDistDir))});