'use strict';var gulp=require('gulp'),runSequence=require('run-sequence'),gutil=require('gulp-util'),plumber=require('gulp-plumber'),gulpif=require('gulp-if'),rename=require('gulp-rename'),filesizegzip=require('filesizegzip'),tap=require('gulp-tap'),sass=require('gulp-sass'),eyeglass=require('eyeglass'),cssnano=require('cssnano'),sourcemaps=require('gulp-sourcemaps'),postcss=require('gulp-postcss'),scss=require('postcss-scss'),assets=require('postcss-assets'),stylelint=require('stylelint'),reporter=require('postcss-reporter'),autoprefixer=require('autoprefixer'),rev=require('gulp-rev'),config=require('../config'),pathBuilder=require('../pathBuilder');gulp.task('css',function(a){runSequence('css:lint','css:bundle',a)});var lintSrc=[pathBuilder.scssSrcDir+'/**/*.scss'].concat(config.css.lintPaths);gulp.task('css:lint',function(){return gulp.src(lintSrc,{follow:config.isDev}).pipe(plumber(config.gulp.onError)).pipe(postcss([stylelint(),reporter({clearMessages:!0,throwError:!0})],{syntax:scss}))}),gulp.task('css:bundle',['clean:css'],function(){return gulp.src(pathBuilder.scssSrcDir+'/**/*.scss').pipe(plumber(config.gulp.onError)).pipe(gulpif(config.isDev,sourcemaps.init())).pipe(sass(eyeglass())).pipe(postcss([assets({loadPaths:[pathBuilder.imgSrcDir]}),autoprefixer()])).pipe(gulpif(config.misc.showFileSize,tap(function(a){gutil.log('\u276F\u276F CSS '+a.relative,filesizegzip(a.contents,!0))}))).pipe(gulp.dest(pathBuilder.cssDistDir)).pipe(postcss([cssnano()])).pipe(gulpif(config.docs.outputAssets,gulp.dest(pathBuilder.docsCssDistDir))).pipe(rename({suffix:'.min'})).pipe(gulpif(config.misc.showFileSize,tap(function(a){gutil.log('\u276F\u276F Minified CSS '+a.relative,filesizegzip(a.contents,!0))}))).pipe(gulpif(config.isDev,sourcemaps.write(void 0,{sourceRoot:null}))).pipe(rev()).pipe(gulp.dest(pathBuilder.cssDistDir))});